You are the lead engineer + product designer for the Vitrya CRM.
Execute ETAPA 2 (Leads Professional) end-to-end with no skipped steps, keeping a premium UI consistent with the existing design system.

BRANCH / SAFETY
- Work ONLY on branch: dev
- Do NOT push to remote; create local commits only.
- Must pass: npm run build before finishing.
- Avoid breaking existing logic; refactor incrementally.

SCOPE (ETAPA 2 DELIVERABLES)

A) Leads List PRO (/leads)
1) Add search input that filters by name/phone/email (client-side if small dataset; server-side if already paginated).
2) Add filters:
   - Pipeline (dropdown)
   - Stage (dropdown dependent on pipeline)
   - Status (open/won/lost)
3) Add sorting:
   - Most recent (default)
   - Name (A-Z)
   - Stage position
4) Add row/card quick actions:
   - Open details
   - Move stage (quick select)
   - Mark won / mark lost
5) Ensure premium states:
   - Skeleton on load
   - EmptyState when no leads
   - InlineError on failure
6) Ensure responsive layout (table on desktop, cards on mobile).

B) Lead Details 360Â° (NEW route)
1) Create route: /leads/[id]
2) Page layout:
   - Header: Lead title, status badge, current pipeline + stage, primary actions.
   - Cards: Contact, Interest/Origin, Notes, Next action (placeholder).
3) Timeline:
   - Show stage changes (from -> to, date, user if available).
   - Use existing DB tables (lead_stage_changes / audit if present).
   - If missing data, render an empty timeline state gracefully.
4) Actions:
   - Edit lead (opens modal or separate edit mode)
   - Move stage
   - Mark won/lost
5) Keep all UI consistent with components/ui and tokens.

C) Editing
1) Add an Edit Lead form (modal or page section) with validation:
   - Required fields labeled
   - Inline error messages
   - Submit loading state
2) On success: toast + refresh data.

D) Technical / Quality
1) Use server actions or route handlers consistently with existing project style.
2) Ensure no hydration issues (dates rendered client-safe if needed).
3) Ensure npm run build passes.

COMMITS (local only)
Create commits in logical chunks:
1) "feat(leads): add search, filters and sorting to leads list"
2) "feat(leads): add lead details page with 360 view"
3) "feat(leads): add timeline and quick actions (move/won/lost)"
4) "chore(leads): polish states, responsiveness, and UX consistency"

OUTPUT
- Provide a summary of files changed.
- Provide a 12-step test checklist covering list + details + won/lost + move stage + responsiveness.
Stop after commits.
